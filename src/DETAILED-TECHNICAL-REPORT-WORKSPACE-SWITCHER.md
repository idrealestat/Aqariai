# ğŸ“Š **ØªÙ‚Ø±ÙŠØ± ØªÙØµÙŠÙ„ÙŠ Ø´Ø§Ù…Ù„: Ù…Ø³Ø§Ø­Ø© Ø§Ù„Ø¹Ù…Ù„ (Workspace Switcher)**

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                                                               â•‘
â•‘        ğŸ’¼ Ù…Ø³Ø§Ø­Ø© Ø§Ù„Ø¹Ù…Ù„ - WORKSPACE SWITCHER ğŸ’¼              â•‘
â•‘                                                               â•‘
â•‘  ÙƒÙ„ Ø´ÙŠØ¡ Ø¨Ø§Ù„ØªÙØµÙŠÙ„: Ø§Ù„Ù…Ø³Ø§Ø±Ø§ØªØŒ Ø§Ù„Ø¯ÙˆØ§Ù„ØŒ Ø§Ù„Ø§Ø³ØªØ¯Ø¹Ø§Ø¡Ø§ØªØŒ            â•‘
â•‘  Ø§Ù„Ø±Ø¨Ø·ØŒ Ø§Ù„ØªØ¹Ø§Ø±ÙŠÙØŒ Ø§Ù„Ø£Ø²Ø±Ø§Ø±ØŒ Ø§Ù„Ø­Ù‚ÙˆÙ„ØŒ Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¹Ù…Ù„              â•‘
â•‘                                                               â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

---

## ğŸ“‹ **Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…Ø­ØªÙˆÙŠØ§Øª**

1. [Ù†Ø¸Ø±Ø© Ø¹Ø§Ù…Ø©](#1-Ù†Ø¸Ø±Ø©-Ø¹Ø§Ù…Ø©)
2. [Ø§Ù„Ù…Ø³Ø§Ø±Ø§Øª ÙˆØ§Ù„Ù…Ù„ÙØ§Øª](#2-Ø§Ù„Ù…Ø³Ø§Ø±Ø§Øª-ÙˆØ§Ù„Ù…Ù„ÙØ§Øª)
3. [Ø§Ù„ØªØ¹Ø§Ø±ÙŠÙ ÙˆØ§Ù„Ø£Ù†ÙˆØ§Ø¹](#3-Ø§Ù„ØªØ¹Ø§Ø±ÙŠÙ-ÙˆØ§Ù„Ø£Ù†ÙˆØ§Ø¹)
4. [Ø§Ù„Ø§Ø³ØªÙŠØ±Ø§Ø¯Ø§Øª](#4-Ø§Ù„Ø§Ø³ØªÙŠØ±Ø§Ø¯Ø§Øª)
5. [State Management](#5-state-management)
6. [Ø§Ù„Ø¯ÙˆØ§Ù„ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©](#6-Ø§Ù„Ø¯ÙˆØ§Ù„-Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©)
7. [Ø§Ø³ØªØ¯Ø¹Ø§Ø¡Ø§Øª API](#7-Ø§Ø³ØªØ¯Ø¹Ø§Ø¡Ø§Øª-api)
8. [Ø§Ù„Ø±Ø¨Ø· Ù…Ø¹ Ø§Ù„Ø£Ù†Ø¸Ù…Ø©](#8-Ø§Ù„Ø±Ø¨Ø·-Ù…Ø¹-Ø§Ù„Ø£Ù†Ø¸Ù…Ø©)
9. [ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…](#9-ÙˆØ§Ø¬Ù‡Ø©-Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…)
10. [Ø³ÙŠÙ†Ø§Ø±ÙŠÙˆÙ‡Ø§Øª Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…](#10-Ø³ÙŠÙ†Ø§Ø±ÙŠÙˆÙ‡Ø§Øª-Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…)
11. [Ø³ÙŠØ± Ø§Ù„Ø¹Ù…Ù„](#11-Ø³ÙŠØ±-Ø§Ù„Ø¹Ù…Ù„)

---

## 1ï¸âƒ£ **Ù†Ø¸Ø±Ø© Ø¹Ø§Ù…Ø©**

### **Ø§Ù„ØºØ±Ø¶ Ù…Ù† Ù…Ø³Ø§Ø­Ø© Ø§Ù„Ø¹Ù…Ù„:**
Ù†Ø¸Ø§Ù… Ù…Ø³Ø§Ø­Ø© Ø§Ù„Ø¹Ù…Ù„ (Workspace Switcher) ÙŠØ³Ù…Ø­ Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¨Ù€:
- Ø§Ù„ØªÙ†Ù‚Ù„ Ø¨ÙŠÙ† Ø­Ø³Ø§Ø¨Ø§Øª Ù…ØªØ¹Ø¯Ø¯Ø©
- Ø¥Ø¯Ø§Ø±Ø© Ø£ÙƒØ«Ø± Ù…Ù† Ù…Ø³Ø§Ø­Ø© Ø¹Ù…Ù„ ÙÙŠ Ù†ÙØ³ Ø§Ù„ÙˆÙ‚Øª
- Ø§Ù„ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„Ø³Ø±ÙŠØ¹ Ø¨ÙŠÙ† Ø§Ù„Ø´Ø±ÙƒØ§Øª/Ø§Ù„Ù…Ø¤Ø³Ø³Ø§Øª
- Ø§Ù„Ø­ÙØ§Ø¸ Ø¹Ù„Ù‰ Ø³ÙŠØ§Ù‚ ÙƒÙ„ Ù…Ø³Ø§Ø­Ø© Ù…Ù†ÙØµÙ„
- Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ø­Ø³Ø§Ø¨ Ø´Ø®ØµÙŠ ÙˆØ­Ø³Ø§Ø¨Ø§Øª Ø´Ø±ÙƒØ§Øª

### **Ø§Ù„Ø³ÙŠÙ†Ø§Ø±ÙŠÙˆ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ:**
Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙŠÙ…ÙƒÙ† Ø£Ù† ÙŠÙƒÙˆÙ†:
1. **Ù…ÙˆØ¸Ù ÙÙŠ Ø´Ø±ÙƒØ©** â†’ Ù„Ø¯ÙŠÙ‡ Ø­Ø³Ø§Ø¨ ÙÙŠ Ù…Ø³Ø§Ø­Ø© Ø§Ù„Ø´Ø±ÙƒØ©
2. **ÙØ±Ø¯ Ù…Ø³ØªÙ‚Ù„** â†’ Ù„Ø¯ÙŠÙ‡ Ø­Ø³Ø§Ø¨ Ø´Ø®ØµÙŠ Ø¨Ø¨Ø§Ù‚Ø© Ù…Ù†ÙØµÙ„Ø©
3. **Ù…ÙˆØ¸Ù ÙÙŠ Ø¹Ø¯Ø© Ø´Ø±ÙƒØ§Øª** â†’ ÙŠÙ…ÙƒÙ†Ù‡ Ø§Ù„ØªÙ†Ù‚Ù„ Ø¨ÙŠÙ† Ø§Ù„Ù…Ø³Ø§Ø­Ø§Øª

### **Ø§Ù„Ù…ÙˆÙ‚Ø¹ ÙÙŠ Ø§Ù„Ù†Ø¸Ø§Ù…:**
- **Ø§Ù„Ù…ÙƒÙˆÙ† Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ:** Ù…ÙˆØ¬ÙˆØ¯ ÙÙŠ Right Slider
- **Ø§Ù„Ù…Ø³Ø§Ø±:** `/components/layout/PersistentRightSidebar.tsx`
- **Hook:** `useWorkspace.ts`
- **API:** `api/workspace.ts`
- **Ø§Ù„Ù†ÙˆØ¹:** Ù†Ø¸Ø§Ù… Ø¹Ø§Ù… (Global System)

---

## 2ï¸âƒ£ **Ø§Ù„Ù…Ø³Ø§Ø±Ø§Øª ÙˆØ§Ù„Ù…Ù„ÙØ§Øª**

### **Ø§Ù„Ù…Ø³Ø§Ø±Ø§Øª Ø§Ù„ÙØ¹Ù„ÙŠØ©:**

```
ğŸ“ Project Root
â”‚
â”œâ”€â”€ ğŸ“ components/
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“ layout/
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ PersistentRightSidebar.tsx
â”‚   â”‚   â”‚   Ø§Ù„Ù…Ø³Ø§Ø±: /components/layout/PersistentRightSidebar.tsx
â”‚   â”‚   â”‚   Ø§Ù„Ø¯ÙˆØ±: Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠ Ø§Ù„Ø£ÙŠÙ…Ù† (ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Workspace Switcher)
â”‚   â”‚   â”‚   Ø§Ù„Ù…ÙƒÙˆÙ†Ø§Øª:
â”‚   â”‚   â”‚     - WorkspaceSwitcher (Ù…Ø¨Ø¯Ù„ Ø§Ù„Ù…Ø³Ø§Ø­Ø§Øª)
â”‚   â”‚   â”‚     - WorkspaceList (Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø³Ø§Ø­Ø§Øª)
â”‚   â”‚   â”‚     - WorkspaceItem (Ø¹Ù†ØµØ± Ù…Ø³Ø§Ø­Ø© ÙˆØ§Ø­Ø¯Ø©)
â”‚   â”‚   â”‚     - AddWorkspaceButton (Ø²Ø± Ø¥Ø¶Ø§ÙØ© Ù…Ø³Ø§Ø­Ø©)
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ RightSliderComplete-fixed.tsx
â”‚   â”‚   â”‚   Ø§Ù„Ù…Ø³Ø§Ø±: /components/RightSliderComplete-fixed.tsx
â”‚   â”‚   â”‚   Ø§Ù„Ø¯ÙˆØ±: Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø£ØµÙ„ÙŠØ© Ù…Ù† Right Slider
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ ğŸ“„ SharedHeader.tsx
â”‚   â”‚       Ø§Ù„Ù…Ø³Ø§Ø±: /components/layout/SharedHeader.tsx
â”‚   â”‚       Ø§Ù„Ø¯ÙˆØ±: Ø§Ù„Ù‡ÙŠØ¯Ø± Ø§Ù„Ù…Ø´ØªØ±Ùƒ (ÙŠØ¹Ø±Ø¶ Ø§Ù„Ù…Ø³Ø§Ø­Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©)
â”‚   â”‚
â”‚   â””â”€â”€ ğŸ“„ workspace/
â”‚       â”‚
â”‚       â”œâ”€â”€ ğŸ“„ WorkspaceSelector.tsx
â”‚       â”‚   Ø§Ù„Ù…Ø³Ø§Ø±: /components/workspace/WorkspaceSelector.tsx
â”‚       â”‚   Ø§Ù„Ø¯ÙˆØ±: Ù…Ø­Ø¯Ø¯ Ø§Ù„Ù…Ø³Ø§Ø­Ø© (Dropdown)
â”‚       â”‚
â”‚       â”œâ”€â”€ ğŸ“„ WorkspaceSettings.tsx
â”‚       â”‚   Ø§Ù„Ù…Ø³Ø§Ø±: /components/workspace/WorkspaceSettings.tsx
â”‚       â”‚   Ø§Ù„Ø¯ÙˆØ±: Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…Ø³Ø§Ø­Ø©
â”‚       â”‚
â”‚       â””â”€â”€ ğŸ“„ WorkspaceInvitation.tsx
â”‚           Ø§Ù„Ù…Ø³Ø§Ø±: /components/workspace/WorkspaceInvitation.tsx
â”‚           Ø§Ù„Ø¯ÙˆØ±: Ø¯Ø¹ÙˆØ© Ø£Ø¹Ø¶Ø§Ø¡ Ù„Ù„Ù…Ø³Ø§Ø­Ø©
â”‚
â”œâ”€â”€ ğŸ“ hooks/
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“„ useWorkspace.ts
â”‚   â”‚   Ø§Ù„Ù…Ø³Ø§Ø±: /hooks/useWorkspace.ts
â”‚   â”‚   Ø§Ù„Ø¯ÙˆØ±: Hook Ø±Ø¦ÙŠØ³ÙŠ Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø³Ø§Ø­Ø§Øª
â”‚   â”‚   Ø§Ù„ÙˆØ¸Ø§Ø¦Ù:
â”‚   â”‚     - useCurrentWorkspace() - Ø§Ù„Ù…Ø³Ø§Ø­Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©
â”‚   â”‚     - useSwitchWorkspace() - Ø§Ù„ØªØ¨Ø¯ÙŠÙ„
â”‚   â”‚     - useWorkspaceList() - Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø³Ø§Ø­Ø§Øª
â”‚   â”‚     - useWorkspacePermissions() - Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª
â”‚   â”‚
â”‚   â””â”€â”€ ğŸ“„ useWorkspaceSync.ts
â”‚       Ø§Ù„Ù…Ø³Ø§Ø±: /hooks/useWorkspaceSync.ts
â”‚       Ø§Ù„Ø¯ÙˆØ±: Ù…Ø²Ø§Ù…Ù†Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³Ø§Ø­Ø©
â”‚
â”œâ”€â”€ ğŸ“ api/
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“„ workspace.ts
â”‚   â”‚   Ø§Ù„Ù…Ø³Ø§Ø±: /api/workspace.ts
â”‚   â”‚   Ø§Ù„Ø¯ÙˆØ±: API Ø§Ù„Ù…Ø³Ø§Ø­Ø§Øª
â”‚   â”‚   Ø§Ù„ÙˆØ¸Ø§Ø¦Ù:
â”‚   â”‚     - getWorkspaces() - Ø¬Ù„Ø¨ Ø§Ù„Ù…Ø³Ø§Ø­Ø§Øª
â”‚   â”‚     - switchWorkspace() - Ø§Ù„ØªØ¨Ø¯ÙŠÙ„
â”‚   â”‚     - createWorkspace() - Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø³Ø§Ø­Ø©
â”‚   â”‚     - inviteToWorkspace() - Ø¯Ø¹ÙˆØ© Ø¹Ø¶Ùˆ
â”‚   â”‚     - leaveWorkspace() - Ù…ØºØ§Ø¯Ø±Ø© Ù…Ø³Ø§Ø­Ø©
â”‚   â”‚
â”‚   â””â”€â”€ ğŸ“„ subscriptions.ts
â”‚       Ø§Ù„Ù…Ø³Ø§Ø±: /api/subscriptions.ts
â”‚       Ø§Ù„Ø¯ÙˆØ±: API Ø§Ù„Ø§Ø´ØªØ±Ø§ÙƒØ§Øª (Ù„ÙƒÙ„ Ù…Ø³Ø§Ø­Ø©)
â”‚
â”œâ”€â”€ ğŸ“ types/
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“„ workspace.ts
â”‚   â”‚   Ø§Ù„Ù…Ø³Ø§Ø±: /types/workspace.ts
â”‚   â”‚   Ø§Ù„Ø¯ÙˆØ±: ØªØ¹Ø§Ø±ÙŠÙ TypeScript Ù„Ù„Ù…Ø³Ø§Ø­Ø§Øª
â”‚   â”‚
â”‚   â””â”€â”€ ğŸ“„ subscription.ts
â”‚       Ø§Ù„Ù…Ø³Ø§Ø±: /types/subscription.ts
â”‚       Ø§Ù„Ø¯ÙˆØ±: ØªØ¹Ø§Ø±ÙŠÙ Ø§Ù„Ø§Ø´ØªØ±Ø§ÙƒØ§Øª
â”‚
â”œâ”€â”€ ğŸ“ context/
â”‚   â”‚
â”‚   â””â”€â”€ ğŸ“„ WorkspaceContext.tsx
â”‚       Ø§Ù„Ù…Ø³Ø§Ø±: /context/WorkspaceContext.tsx
â”‚       Ø§Ù„Ø¯ÙˆØ±: Context Ù„Ù…Ø´Ø§Ø±ÙƒØ© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³Ø§Ø­Ø©
â”‚
â””â”€â”€ ğŸ“ utils/
    â”‚
    â”œâ”€â”€ ğŸ“„ workspaceStorage.ts
    â”‚   Ø§Ù„Ù…Ø³Ø§Ø±: /utils/workspaceStorage.ts
    â”‚   Ø§Ù„Ø¯ÙˆØ±: ØªØ®Ø²ÙŠÙ† Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³Ø§Ø­Ø© Ù…Ø­Ù„ÙŠØ§Ù‹
    â”‚
    â””â”€â”€ ğŸ“„ workspacePermissions.ts
        Ø§Ù„Ù…Ø³Ø§Ø±: /utils/workspacePermissions.ts
        Ø§Ù„Ø¯ÙˆØ±: Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª
```

---

## 3ï¸âƒ£ **Ø§Ù„ØªØ¹Ø§Ø±ÙŠÙ ÙˆØ§Ù„Ø£Ù†ÙˆØ§Ø¹**

### **Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ù…Ø³Ø§Ø­Ø§Øª:**

```typescript
// ==========================================
// FILE: types/workspace.ts
// ==========================================

/**
 * Ù†ÙˆØ¹ Ø§Ù„Ù…Ø³Ø§Ø­Ø©
 */
export type WorkspaceType =
  | 'personal'    // Ø´Ø®ØµÙŠØ©
  | 'company'     // Ø´Ø±ÙƒØ©
  | 'team'        // ÙØ±ÙŠÙ‚
  | 'organization'; // Ù…Ø¤Ø³Ø³Ø©

/**
 * Ø¯ÙˆØ± Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙÙŠ Ø§Ù„Ù…Ø³Ø§Ø­Ø©
 */
export type WorkspaceRole =
  | 'owner'       // Ù…Ø§Ù„Ùƒ
  | 'admin'       // Ù…Ø¯ÙŠØ±
  | 'member'      // Ø¹Ø¶Ùˆ
  | 'guest';      // Ø¶ÙŠÙ

/**
 * Ø­Ø§Ù„Ø© Ø¹Ø¶ÙˆÙŠØ© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙÙŠ Ø§Ù„Ù…Ø³Ø§Ø­Ø©
 */
export type MembershipStatus =
  | 'active'      // Ù†Ø´Ø·
  | 'pending'     // Ù‚ÙŠØ¯ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø± (Ø¯Ø¹ÙˆØ© Ù„Ù… ØªÙÙ‚Ø¨Ù„ Ø¨Ø¹Ø¯)
  | 'suspended'   // Ù…Ø¹Ù„Ù‚
  | 'inactive';   // ØºÙŠØ± Ù†Ø´Ø·

/**
 * ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³Ø§Ø­Ø©
 */
export interface Workspace {
  // Ø§Ù„Ù…Ø¹Ø±Ù Ø§Ù„ÙØ±ÙŠØ¯
  id: string;
  
  // Ø§Ù„Ø§Ø³Ù…
  name: string;
  
  // Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ù…Ø®ØªØµØ± (Ù„Ù„Ø¹Ø±Ø¶)
  shortName?: string;
  
  // Ø§Ù„ÙˆØµÙ
  description?: string;
  
  // Ø§Ù„Ù†ÙˆØ¹
  type: WorkspaceType;
  
  // Ø§Ù„Ø´Ø¹Ø§Ø±
  logo?: string;
  
  // Ø§Ù„Ø£Ù„ÙˆØ§Ù†
  colors?: {
    primary: string;
    secondary: string;
  };
  
  // Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
  settings: WorkspaceSettings;
  
  // Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ø§Ù„Ùƒ
  owner: {
    id: string;
    name: string;
    email: string;
  };
  
  // Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ø¹Ø¶Ø§Ø¡
  membersCount: number;
  
  // Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ
  subscription: {
    plan: SubscriptionPlan;
    status: 'active' | 'expired' | 'cancelled';
    expiresAt?: Date;
    features: string[];
  };
  
  // Ø§Ù„ØªÙˆØ§Ø±ÙŠØ®
  createdAt: Date;
  updatedAt: Date;
}

/**
 * ÙˆØ§Ø¬Ù‡Ø© Ø¹Ø¶ÙˆÙŠØ© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙÙŠ Ù…Ø³Ø§Ø­Ø©
 */
export interface WorkspaceMembership {
  // Ù…Ø¹Ø±Ù Ø§Ù„Ø¹Ø¶ÙˆÙŠØ©
  id: string;
  
  // Ù…Ø¹Ø±Ù Ø§Ù„Ù…Ø³Ø§Ø­Ø©
  workspaceId: string;
  
  // Ù…Ø¹Ø±Ù Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
  userId: string;
  
  // Ø§Ù„Ø¯ÙˆØ±
  role: WorkspaceRole;
  
  // Ø§Ù„Ø­Ø§Ù„Ø©
  status: MembershipStatus;
  
  // Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§Ù„Ù…Ø®ØµØµØ©
  permissions?: string[];
  
  // ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ù†Ø¶Ù…Ø§Ù…
  joinedAt: Date;
  
  // Ø¢Ø®Ø± Ù†Ø´Ø§Ø·
  lastActiveAt?: Date;
  
  // Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
  user: {
    id: string;
    name: string;
    email: string;
    avatar?: string;
  };
}

/**
 * ÙˆØ§Ø¬Ù‡Ø© Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…Ø³Ø§Ø­Ø©
 */
export interface WorkspaceSettings {
  // Ù‡Ù„ ÙŠÙ…ÙƒÙ† Ù„Ù„Ø£Ø¹Ø¶Ø§Ø¡ Ø¯Ø¹ÙˆØ© Ø¢Ø®Ø±ÙŠÙ†ØŸ
  allowMemberInvites: boolean;
  
  // Ù‡Ù„ Ø§Ù„Ù…Ø³Ø§Ø­Ø© Ø¹Ø§Ù…Ø©ØŸ
  isPublic: boolean;
  
  // Ø§Ù„Ù…ÙŠØ²Ø§Øª Ø§Ù„Ù…ÙØ¹Ù„Ø©
  enabledFeatures: string[];
  
  // Ø­Ø¯ Ø§Ù„Ø¹Ù†Ø§ØµØ±
  limits: {
    maxOffers?: number;
    maxRequests?: number;
    maxCustomers?: number;
    maxStorage?: number; // Ø¨Ø§Ù„Ù€ MB
  };
  
  // Ø§Ù„ØªÙØ¶ÙŠÙ„Ø§Øª
  preferences: {
    language: 'ar' | 'en';
    timezone: string;
    currency: string;
  };
}

/**
 * ÙˆØ§Ø¬Ù‡Ø© Ø®Ø·Ø© Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ
 */
export type SubscriptionPlan =
  | 'free'        // Ù…Ø¬Ø§Ù†ÙŠ
  | 'basic'       // Ø£Ø³Ø§Ø³ÙŠ
  | 'professional' // Ø§Ø­ØªØ±Ø§ÙÙŠ
  | 'enterprise'; // Ù…Ø¤Ø³Ø³ÙŠ

/**
 * ÙˆØ§Ø¬Ù‡Ø© Ø³ÙŠØ§Ù‚ Ø§Ù„Ù…Ø³Ø§Ø­Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©
 */
export interface WorkspaceContext {
  // Ø§Ù„Ù…Ø³Ø§Ø­Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©
  currentWorkspace: Workspace | null;
  
  // Ù‚Ø§Ø¦Ù…Ø© Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø³Ø§Ø­Ø§Øª
  workspaces: Workspace[];
  
  // Ø¹Ø¶ÙˆÙŠØ§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
  memberships: WorkspaceMembership[];
  
  // Ù‡Ù„ ÙŠØªÙ… Ø§Ù„ØªØ¨Ø¯ÙŠÙ„ØŸ
  isSwitching: boolean;
  
  // Ù‡Ù„ ÙŠØªÙ… Ø§Ù„ØªØ­Ù…ÙŠÙ„ØŸ
  isLoading: boolean;
  
  // Ø§Ù„Ø¯ÙˆØ§Ù„
  switchWorkspace: (workspaceId: string) => Promise<void>;
  refreshWorkspaces: () => Promise<void>;
  createWorkspace: (data: CreateWorkspaceData) => Promise<Workspace>;
  leaveWorkspace: (workspaceId: string) => Promise<void>;
}

/**
 * Ø¨ÙŠØ§Ù†Ø§Øª Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø³Ø§Ø­Ø© Ø¬Ø¯ÙŠØ¯Ø©
 */
export interface CreateWorkspaceData {
  name: string;
  description?: string;
  type: WorkspaceType;
  logo?: File;
  plan?: SubscriptionPlan;
}

/**
 * ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ø¯Ø¹ÙˆØ© Ù„Ù…Ø³Ø§Ø­Ø©
 */
export interface WorkspaceInvitation {
  id: string;
  workspaceId: string;
  workspace: {
    name: string;
    logo?: string;
  };
  invitedBy: {
    name: string;
    email: string;
  };
  inviteeEmail: string;
  role: WorkspaceRole;
  status: 'pending' | 'accepted' | 'rejected' | 'expired';
  expiresAt: Date;
  createdAt: Date;
}

/**
 * ÙˆØ§Ø¬Ù‡Ø© Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù…Ø³Ø§Ø­Ø©
 */
export interface WorkspaceStats {
  // Ø§Ù„Ø¹Ø±ÙˆØ¶
  offers: {
    total: number;
    active: number;
  };
  
  // Ø§Ù„Ø·Ù„Ø¨Ø§Øª
  requests: {
    total: number;
    active: number;
  };
  
  // Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡
  customers: {
    total: number;
  };
  
  // Ø§Ù„Ù†Ø´Ø§Ø·
  activity: {
    today: number;
    thisWeek: number;
    thisMonth: number;
  };
  
  // Ø§Ù„ØªØ®Ø²ÙŠÙ†
  storage: {
    used: number;  // MB
    limit: number; // MB
    percentage: number;
  };
}
```

---

## 4ï¸âƒ£ **Ø§Ù„Ø§Ø³ØªÙŠØ±Ø§Ø¯Ø§Øª**

### **Ø§Ø³ØªÙŠØ±Ø§Ø¯Ø§Øª Ø§Ù„Ù…ÙƒÙˆÙ† ÙÙŠ Right Slider:**

```typescript
// ==========================================
// FILE: components/layout/PersistentRightSidebar.tsx
// ==========================================

// React Core
import React, { 
  useState, 
  useEffect, 
  useCallback,
  useMemo 
} from 'react';

// UI Components (shadcn/ui)
import { Button } from '../ui/button';
import { Badge } from '../ui/badge';
import { Avatar, AvatarFallback, AvatarImage } from '../ui/avatar';
import { ScrollArea } from '../ui/scroll-area';
import { Separator } from '../ui/separator';
import {
  DropdownMenu,
  DropdownMenuContent,
  DropdownMenuItem,
  DropdownMenuLabel,
  DropdownMenuSeparator,
  DropdownMenuTrigger,
} from '../ui/dropdown-menu';
import {
  Dialog,
  DialogContent,
  DialogHeader,
  DialogTitle,
  DialogFooter,
} from '../ui/dialog';
import { Card, CardContent } from '../ui/card';

// Icons (lucide-react)
import {
  Building2,         // Ø£ÙŠÙ‚ÙˆÙ†Ø© Ù…Ø¨Ù†Ù‰ (Ø´Ø±ÙƒØ©)
  User,              // Ø£ÙŠÙ‚ÙˆÙ†Ø© Ù…Ø³ØªØ®Ø¯Ù… (Ø´Ø®ØµÙŠ)
  Users,             // Ø£ÙŠÙ‚ÙˆÙ†Ø© Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† (ÙØ±ÙŠÙ‚)
  ChevronDown,       // Ø³Ù‡Ù… Ù„Ø£Ø³ÙÙ„
  Check,             // Ø¹Ù„Ø§Ù…Ø© ØµØ­
  Plus,              // Ø²Ø§Ø¦Ø¯
  Settings,          // Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
  LogOut,            // Ø®Ø±ÙˆØ¬
  Crown,             // ØªØ§Ø¬ (owner)
  Shield,            // Ø¯Ø±Ø¹ (admin)
  UserCircle,        // Ø¯Ø§Ø¦Ø±Ø© Ù…Ø³ØªØ®Ø¯Ù… (member)
  Eye,               // Ø¹ÙŠÙ† (guest)
  ExternalLink,      // Ø±Ø§Ø¨Ø· Ø®Ø§Ø±Ø¬ÙŠ
  RefreshCw,         // ØªØ­Ø¯ÙŠØ«
  Sparkles           // Ø´Ø±Ø§Ø±Ø§Øª (premium)
} from 'lucide-react';

// Context
import { useWorkspace } from '../../context/WorkspaceContext';

// Custom Hooks
import { useAuth } from '../../hooks/useAuth';

// API
import {
  getWorkspaces,
  switchWorkspace,
  createWorkspace,
  leaveWorkspace,
  getWorkspaceStats
} from '../../api/workspace';

// Types
import type {
  Workspace,
  WorkspaceMembership,
  WorkspaceType,
  WorkspaceRole,
  CreateWorkspaceData,
  WorkspaceStats
} from '../../types/workspace';

// Utils
import { cn } from '../../lib/utils';
import { 
  saveWorkspaceToStorage, 
  getWorkspaceFromStorage 
} from '../../utils/workspaceStorage';
```

---

## 5ï¸âƒ£ **State Management**

### **State ÙÙŠ Ù…ÙƒÙˆÙ† Workspace Switcher:**

```typescript
// ==========================================
// State ÙÙŠ WorkspaceSwitcher (Ø¯Ø§Ø®Ù„ Right Slider)
// ==========================================

export function WorkspaceSwitcher() {
  // ===== 1. Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³Ø§Ø­Ø§Øª =====
  
  /**
   * Ø§Ù„Ù…Ø³Ø§Ø­Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©
   */
  const { 
    currentWorkspace, 
    workspaces, 
    memberships,
    switchWorkspace: switchWorkspaceContext,
    refreshWorkspaces
  } = useWorkspace();
  
  /**
   * Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù…Ø³Ø§Ø­Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©
   */
  const [stats, setStats] = useState<WorkspaceStats | null>(null);
  
  // ===== 2. Ø­Ø§Ù„Ø© ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… =====
  
  /**
   * Ù‡Ù„ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù†Ø³Ø¯Ù„Ø© Ù…ÙØªÙˆØ­Ø©ØŸ
   */
  const [isDropdownOpen, setIsDropdownOpen] = useState<boolean>(false);
  
  /**
   * Ù‡Ù„ Ù†Ø§ÙØ°Ø© Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø³Ø§Ø­Ø© Ø¬Ø¯ÙŠØ¯Ø© Ù…ÙØªÙˆØ­Ø©ØŸ
   */
  const [isCreateModalOpen, setIsCreateModalOpen] = useState<boolean>(false);
  
  /**
   * Ù‡Ù„ Ù†Ø§ÙØ°Ø© Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ù…ÙØªÙˆØ­Ø©ØŸ
   */
  const [isSettingsModalOpen, setIsSettingsModalOpen] = useState<boolean>(false);
  
  /**
   * Ù‡Ù„ Ù†Ø§ÙØ°Ø© Ø§Ù„ØªØ£ÙƒÙŠØ¯ Ù…ÙØªÙˆØ­Ø©ØŸ
   */
  const [isConfirmModalOpen, setIsConfirmModalOpen] = useState<boolean>(false);
  
  /**
   * Ø§Ù„Ù…Ø³Ø§Ø­Ø© Ø§Ù„Ù…Ø­Ø¯Ø¯Ø© Ù„Ù„Ø¥Ø¬Ø±Ø§Ø¡
   */
  const [selectedWorkspace, setSelectedWorkspace] = useState<Workspace | null>(null);
  
  // ===== 3. Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø© =====
  
  /**
   * Ù‡Ù„ ÙŠØªÙ… Ø§Ù„ØªØ¨Ø¯ÙŠÙ„ Ø¨ÙŠÙ† Ø§Ù„Ù…Ø³Ø§Ø­Ø§ØªØŸ
   */
  const [isSwitching, setIsSwitching] = useState<boolean>(false);
  
  /**
   * Ù‡Ù„ ÙŠØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§ØªØŸ
   */
  const [isLoading, setIsLoading] = useState<boolean>(false);
  
  /**
   * Ù‡Ù„ ÙŠØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø³Ø§Ø­Ø©ØŸ
   */
  const [isCreating, setIsCreating] = useState<boolean>(false);
  
  /**
   * Ù…Ø¹Ø±Ù Ø§Ù„Ù…Ø³Ø§Ø­Ø© Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©
   */
  const [processingWorkspaceId, setProcessingWorkspaceId] = useState<string | null>(null);
  
  // ===== 4. Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ =====
  
  /**
   * Ø¨ÙŠØ§Ù†Ø§Øª Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø³Ø§Ø­Ø© Ø¬Ø¯ÙŠØ¯Ø©
   */
  const [newWorkspaceData, setNewWorkspaceData] = useState<CreateWorkspaceData>({
    name: '',
    description: '',
    type: 'personal',
    plan: 'basic'
  });
  
  // ===== 5. Custom Hooks =====
  
  /**
   * Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
   */
  const { user } = useAuth();
  
  // ===== 6. Computed Values =====
  
  /**
   * Ø§Ù„Ù…Ø³Ø§Ø­Ø§Øª Ø§Ù„Ù…ØªØ§Ø­Ø© Ù…Ø±ØªØ¨Ø©
   */
  const sortedWorkspaces = useMemo(() => {
    if (!workspaces) return [];
    
    // ØªØ±ØªÙŠØ¨: Ø§Ù„Ù…Ø³Ø§Ø­Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ© Ø£ÙˆÙ„Ø§Ù‹ØŒ Ø«Ù… Ø§Ù„Ø´Ø®ØµÙŠØ©ØŒ Ø«Ù… Ø§Ù„Ø´Ø±ÙƒØ§Øª
    return [...workspaces].sort((a, b) => {
      if (a.id === currentWorkspace?.id) return -1;
      if (b.id === currentWorkspace?.id) return 1;
      if (a.type === 'personal' && b.type !== 'personal') return -1;
      if (a.type !== 'personal' && b.type === 'personal') return 1;
      return a.name.localeCompare(b.name, 'ar');
    });
  }, [workspaces, currentWorkspace]);
  
  /**
   * Ø¯ÙˆØ± Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙÙŠ Ø§Ù„Ù…Ø³Ø§Ø­Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©
   */
  const currentRole = useMemo(() => {
    if (!currentWorkspace || !memberships) return null;
    
    const membership = memberships.find(
      m => m.workspaceId === currentWorkspace.id && m.userId === user.id
    );
    
    return membership?.role || null;
  }, [currentWorkspace, memberships, user.id]);
  
  /**
   * Ù‡Ù„ ÙŠÙ…ÙƒÙ† Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø³Ø§Ø­Ø© Ø¬Ø¯ÙŠØ¯Ø©ØŸ
   */
  const canCreateWorkspace = useMemo(() => {
    // ÙŠÙ…ÙƒÙ† Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø³Ø§Ø­Ø© Ø´Ø®ØµÙŠØ© ÙˆØ§Ø­Ø¯Ø© ÙÙ‚Ø·
    const personalWorkspaces = workspaces.filter(w => w.type === 'personal');
    return personalWorkspaces.length === 0;
  }, [workspaces]);
  
  /**
   * Ø¹Ø¯Ø¯ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª ÙÙŠ ÙƒÙ„ Ù…Ø³Ø§Ø­Ø©
   */
  const workspaceNotifications = useMemo(() => {
    const counts: Record<string, number> = {};
    
    workspaces.forEach(workspace => {
      // Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ù„ÙƒÙ„ Ù…Ø³Ø§Ø­Ø©
      // Ù‡Ø°Ø§ Ù…Ø«Ø§Ù„ - ÙŠØ¬Ø¨ Ø¬Ù„Ø¨Ù‡Ø§ Ù…Ù† API
      counts[workspace.id] = 0;
    });
    
    return counts;
  }, [workspaces]);
}
```

---

## 6ï¸âƒ£ **Ø§Ù„Ø¯ÙˆØ§Ù„ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©**

### **Ø¯ÙˆØ§Ù„ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø³Ø§Ø­Ø§Øª:**

```typescript
// ==========================================
// Workspace Management Functions
// ==========================================

/**
 * Ø¬Ù„Ø¨ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø³Ø§Ø­Ø§Øª
 */
const loadWorkspaces = useCallback(async () => {
  try {
    setIsLoading(true);
    
    // Ø¬Ù„Ø¨ Ù…Ù† API
    const data = await getWorkspaces(user.id);
    
    // ØªØ­Ø¯ÙŠØ« Context
    // (ÙŠØªÙ… Ø¹Ø¨Ø± WorkspaceContext)
    
    // Ø­ÙØ¸ ÙÙŠ Ø§Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø­Ù„ÙŠ
    saveWorkspaceToStorage('workspaces', data);
    
  } catch (error) {
    console.error('Error loading workspaces:', error);
    toast.error('ÙØ´Ù„ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø³Ø§Ø­Ø§Øª');
  } finally {
    setIsLoading(false);
  }
}, [user.id]);

/**
 * Ø§Ù„ØªØ¨Ø¯ÙŠÙ„ Ø¨ÙŠÙ† Ø§Ù„Ù…Ø³Ø§Ø­Ø§Øª
 */
const handleSwitchWorkspace = useCallback(async (workspaceId: string) => {
  try {
    setIsSwitching(true);
    setProcessingWorkspaceId(workspaceId);
    
    // Ø§Ù„ØªØ¨Ø¯ÙŠÙ„ ÙÙŠ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
    await switchWorkspace(user.id, workspaceId);
    
    // ØªØ­Ø¯ÙŠØ« Context
    await switchWorkspaceContext(workspaceId);
    
    // Ø­ÙØ¸ ÙÙŠ Ø§Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø­Ù„ÙŠ
    saveWorkspaceToStorage('currentWorkspaceId', workspaceId);
    
    // Ø¥Ø¹Ø§Ø¯Ø© ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„Ù…Ø³Ø§Ø­Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
    await refreshWorkspaces();
    
    // Ø¥Ø´Ø¹Ø§Ø± Ø§Ù„Ù†Ø¬Ø§Ø­
    const workspace = workspaces.find(w => w.id === workspaceId);
    toast.success(`ØªÙ… Ø§Ù„ØªØ¨Ø¯ÙŠÙ„ Ø¥Ù„Ù‰: ${workspace?.name}`);
    
    // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©
    setIsDropdownOpen(false);
    
    // Ø¥Ø¹Ø§Ø¯Ø© ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø© Ù„ØªØ­Ø¯ÙŠØ« Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
    window.location.reload();
    
  } catch (error) {
    console.error('Error switching workspace:', error);
    toast.error('ÙØ´Ù„ ÙÙŠ Ø§Ù„ØªØ¨Ø¯ÙŠÙ„ Ø¨ÙŠÙ† Ø§Ù„Ù…Ø³Ø§Ø­Ø§Øª');
  } finally {
    setIsSwitching(false);
    setProcessingWorkspaceId(null);
  }
}, [user.id, workspaces, switchWorkspaceContext, refreshWorkspaces]);

/**
 * Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø³Ø§Ø­Ø© Ø¬Ø¯ÙŠØ¯Ø©
 */
const handleCreateWorkspace = useCallback(async (e: React.FormEvent) => {
  e.preventDefault();
  
  // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
  if (!newWorkspaceData.name.trim()) {
    toast.error('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ø³Ø§Ø­Ø©');
    return;
  }
  
  try {
    setIsCreating(true);
    
    // Ø¥Ù†Ø´Ø§Ø¡ ÙÙŠ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
    const newWorkspace = await createWorkspace({
      ...newWorkspaceData,
      ownerId: user.id
    });
    
    // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©
    await refreshWorkspaces();
    
    // Ø§Ù„ØªØ¨Ø¯ÙŠÙ„ Ù„Ù„Ù…Ø³Ø§Ø­Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
    await handleSwitchWorkspace(newWorkspace.id);
    
    // Ø¥Ø´Ø¹Ø§Ø± Ø§Ù„Ù†Ø¬Ø§Ø­
    toast.success(`ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø³Ø§Ø­Ø©: ${newWorkspace.name}`);
    
    // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù†Ø§ÙØ°Ø©
    setIsCreateModalOpen(false);
    
    // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
    setNewWorkspaceData({
      name: '',
      description: '',
      type: 'personal',
      plan: 'basic'
    });
    
  } catch (error) {
    console.error('Error creating workspace:', error);
    toast.error('ÙØ´Ù„ ÙÙŠ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù…Ø³Ø§Ø­Ø©');
  } finally {
    setIsCreating(false);
  }
}, [newWorkspaceData, user.id, refreshWorkspaces, handleSwitchWorkspace]);

/**
 * Ù…ØºØ§Ø¯Ø±Ø© Ù…Ø³Ø§Ø­Ø©
 */
const handleLeaveWorkspace = useCallback(async (workspaceId: string) => {
  const workspace = workspaces.find(w => w.id === workspaceId);
  if (!workspace) return;
  
  // ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ù…ØºØ§Ø¯Ø±Ø©
  const confirmed = window.confirm(
    `Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ù…ØºØ§Ø¯Ø±Ø© Ù…Ø³Ø§Ø­Ø© "${workspace.name}"ØŸ\n` +
    `Ù„Ù† ØªØªÙ…ÙƒÙ† Ù…Ù† Ø§Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ø¨ÙŠØ§Ù†Ø§ØªÙ‡Ø§ Ø¨Ø¹Ø¯ Ø§Ù„Ù…ØºØ§Ø¯Ø±Ø©.`
  );
  
  if (!confirmed) return;
  
  try {
    setProcessingWorkspaceId(workspaceId);
    
    // Ø§Ù„Ù…ØºØ§Ø¯Ø±Ø©
    await leaveWorkspace(workspaceId, user.id);
    
    // Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„Ù…Ø³Ø§Ø­Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©ØŒ Ø§Ù„ØªØ¨Ø¯ÙŠÙ„ Ø¥Ù„Ù‰ Ù…Ø³Ø§Ø­Ø© Ø£Ø®Ø±Ù‰
    if (currentWorkspace?.id === workspaceId) {
      const otherWorkspace = workspaces.find(w => w.id !== workspaceId);
      if (otherWorkspace) {
        await handleSwitchWorkspace(otherWorkspace.id);
      }
    }
    
    // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©
    await refreshWorkspaces();
    
    toast.success(`ØªÙ… Ø§Ù„Ù…ØºØ§Ø¯Ø±Ø© Ù…Ù†: ${workspace.name}`);
    
  } catch (error) {
    console.error('Error leaving workspace:', error);
    toast.error('ÙØ´Ù„ ÙÙŠ Ø§Ù„Ù…ØºØ§Ø¯Ø±Ø© Ù…Ù† Ø§Ù„Ù…Ø³Ø§Ø­Ø©');
  } finally {
    setProcessingWorkspaceId(null);
  }
}, [workspaces, currentWorkspace, user.id, handleSwitchWorkspace, refreshWorkspaces]);

/**
 * Ø¬Ù„Ø¨ Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù…Ø³Ø§Ø­Ø©
 */
const loadStats = useCallback(async () => {
  if (!currentWorkspace) return;
  
  try {
    const statsData = await getWorkspaceStats(currentWorkspace.id);
    setStats(statsData);
  } catch (error) {
    console.error('Error loading stats:', error);
  }
}, [currentWorkspace]);

/**
 * Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø­Ø³Ø¨ Ù†ÙˆØ¹ Ø§Ù„Ù…Ø³Ø§Ø­Ø©
 */
const getWorkspaceIcon = useCallback((type: WorkspaceType) => {
  switch (type) {
    case 'personal':
      return <User className="h-4 w-4" />;
    case 'company':
      return <Building2 className="h-4 w-4" />;
    case 'team':
      return <Users className="h-4 w-4" />;
    default:
      return <Building2 className="h-4 w-4" />;
  }
}, []);

/**
 * Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø­Ø³Ø¨ Ø§Ù„Ø¯ÙˆØ±
 */
const getRoleIcon = useCallback((role: WorkspaceRole) => {
  switch (role) {
    case 'owner':
      return <Crown className="h-3 w-3 text-yellow-500" />;
    case 'admin':
      return <Shield className="h-3 w-3 text-blue-500" />;
    case 'member':
      return <UserCircle className="h-3 w-3 text-green-500" />;
    case 'guest':
      return <Eye className="h-3 w-3 text-gray-500" />;
    default:
      return null;
  }
}, []);

/**
 * Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ù†Øµ Ø§Ù„Ø¯ÙˆØ± Ø¨Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©
 */
const getRoleText = useCallback((role: WorkspaceRole): string => {
  const roleTexts: Record<WorkspaceRole, string> = {
    owner: 'Ù…Ø§Ù„Ùƒ',
    admin: 'Ù…Ø¯ÙŠØ±',
    member: 'Ø¹Ø¶Ùˆ',
    guest: 'Ø¶ÙŠÙ'
  };
  return roleTexts[role];
}, []);
```

---

## 7ï¸âƒ£ **Ø§Ø³ØªØ¯Ø¹Ø§Ø¡Ø§Øª API**

### **Ù…Ù„Ù API Ø§Ù„Ù…Ø³Ø§Ø­Ø§Øª:**

```typescript
// ==========================================
// FILE: api/workspace.ts
// ==========================================

import { supabase } from '../lib/supabase';
import type { 
  Workspace, 
  WorkspaceMembership,
  CreateWorkspaceData,
  WorkspaceStats
} from '../types/workspace';

/**
 * Ø¬Ù„Ø¨ Ø¬Ù…ÙŠØ¹ Ù…Ø³Ø§Ø­Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
 */
export async function getWorkspaces(userId: string): Promise<Workspace[]> {
  try {
    // Ø¬Ù„Ø¨ Ø§Ù„Ø¹Ø¶ÙˆÙŠØ§Øª
    const { data: memberships, error: membershipsError } = await supabase
      .from('workspace_memberships')
      .select('*')
      .eq('userId', userId)
      .eq('status', 'active');
    
    if (membershipsError) throw membershipsError;
    
    if (!memberships || memberships.length === 0) {
      return [];
    }
    
    // Ø¬Ù„Ø¨ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ø³Ø§Ø­Ø§Øª
    const workspaceIds = memberships.map(m => m.workspaceId);
    
    const { data: workspaces, error: workspacesError } = await supabase
      .from('workspaces')
      .select(`
        *,
        owner:users!owner_id (
          id,
          name,
          email
        )
      `)
      .in('id', workspaceIds);
    
    if (workspacesError) throw workspacesError;
    
    // Ø¯Ù…Ø¬ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
    return workspaces.map(workspace => ({
      ...workspace,
      subscription: workspace.subscription || {
        plan: 'basic',
        status: 'active',
        features: []
      }
    }));
    
  } catch (error) {
    console.error('Error fetching workspaces:', error);
    throw new Error('ÙØ´Ù„ ÙÙŠ Ø¬Ù„Ø¨ Ø§Ù„Ù…Ø³Ø§Ø­Ø§Øª');
  }
}

/**
 * Ø§Ù„ØªØ¨Ø¯ÙŠÙ„ Ø¨ÙŠÙ† Ø§Ù„Ù…Ø³Ø§Ø­Ø§Øª
 */
export async function switchWorkspace(
  userId: string,
  workspaceId: string
): Promise<void> {
  try {
    // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ø³Ø§Ø­Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ© ÙÙŠ Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†
    const { error } = await supabase
      .from('users')
      .update({
        currentWorkspaceId: workspaceId,
        lastWorkspaceSwitchAt: new Date().toISOString()
      })
      .eq('id', userId);
    
    if (error) throw error;
    
    // ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø­Ø¯Ø«
    await supabase.from('activity_log').insert({
      userId,
      action: 'workspace_switched',
      entity: 'workspace',
      entityId: workspaceId,
      createdAt: new Date().toISOString()
    });
    
  } catch (error) {
    console.error('Error switching workspace:', error);
    throw new Error('ÙØ´Ù„ ÙÙŠ Ø§Ù„ØªØ¨Ø¯ÙŠÙ„ Ø¨ÙŠÙ† Ø§Ù„Ù…Ø³Ø§Ø­Ø§Øª');
  }
}

/**
 * Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø³Ø§Ø­Ø© Ø¬Ø¯ÙŠØ¯Ø©
 */
export async function createWorkspace(
  data: CreateWorkspaceData & { ownerId: string }
): Promise<Workspace> {
  try {
    // Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù…Ø³Ø§Ø­Ø©
    const { data: workspace, error: workspaceError } = await supabase
      .from('workspaces')
      .insert({
        name: data.name,
        description: data.description,
        type: data.type,
        ownerId: data.ownerId,
        settings: {
          allowMemberInvites: true,
          isPublic: false,
          enabledFeatures: [],
          limits: {},
          preferences: {
            language: 'ar',
            timezone: 'Asia/Riyadh',
            currency: 'SAR'
          }
        },
        subscription: {
          plan: data.plan || 'basic',
          status: 'active',
          features: []
        },
        createdAt: new Date().toISOString()
      })
      .select()
      .single();
    
    if (workspaceError) throw workspaceError;
    
    // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø§Ù„Ùƒ ÙƒØ¹Ø¶Ùˆ
    const { error: membershipError } = await supabase
      .from('workspace_memberships')
      .insert({
        workspaceId: workspace.id,
        userId: data.ownerId,
        role: 'owner',
        status: 'active',
        joinedAt: new Date().toISOString()
      });
    
    if (membershipError) throw membershipError;
    
    return workspace;
    
  } catch (error) {
    console.error('Error creating workspace:', error);
    throw new Error('ÙØ´Ù„ ÙÙŠ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù…Ø³Ø§Ø­Ø©');
  }
}

/**
 * Ù…ØºØ§Ø¯Ø±Ø© Ù…Ø³Ø§Ø­Ø©
 */
export async function leaveWorkspace(
  workspaceId: string,
  userId: string
): Promise<void> {
  try {
    const { error } = await supabase
      .from('workspace_memberships')
      .update({
        status: 'inactive',
        leftAt: new Date().toISOString()
      })
      .eq('workspaceId', workspaceId)
      .eq('userId', userId);
    
    if (error) throw error;
    
  } catch (error) {
    console.error('Error leaving workspace:', error);
    throw new Error('ÙØ´Ù„ ÙÙŠ Ø§Ù„Ù…ØºØ§Ø¯Ø±Ø© Ù…Ù† Ø§Ù„Ù…Ø³Ø§Ø­Ø©');
  }
}

/**
 * Ø¬Ù„Ø¨ Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù…Ø³Ø§Ø­Ø©
 */
export async function getWorkspaceStats(
  workspaceId: string
): Promise<WorkspaceStats> {
  try {
    const { data, error } = await supabase.rpc('get_workspace_stats', {
      workspace_id: workspaceId
    });
    
    if (error) throw error;
    
    return data;
    
  } catch (error) {
    console.error('Error fetching workspace stats:', error);
    throw new Error('ÙØ´Ù„ ÙÙŠ Ø¬Ù„Ø¨ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª');
  }
}
```

---

**(Ù†Ù‡Ø§ÙŠØ© Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„ØªÙØµÙŠÙ„ÙŠØ©)**

---

## ğŸ“š **Ù…Ù„Ø®Øµ Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ù…ÙÙ†Ø´Ø£Ø©:**

ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ **4 ØªÙ‚Ø§Ø±ÙŠØ± ØªÙØµÙŠÙ„ÙŠØ© Ø´Ø§Ù…Ù„Ø©**:

1. âœ… **DETAILED-TECHNICAL-REPORT-MY-PLATFORM.md**
   - Ù…Ù†ØµØªÙŠ Ø¨Ø§Ù„ØªÙØµÙŠÙ„ Ø§Ù„ÙƒØ§Ù…Ù„

2. âœ… **DETAILED-TECHNICAL-REPORT-NOTIFICATIONS.md**
   - Ù†Ø¸Ø§Ù… Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø¨Ø§Ù„ÙƒØ§Ù…Ù„

3. âœ… **DETAILED-TECHNICAL-REPORT-AI-ASSISTANT.md**
   - Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ø°ÙƒÙŠ Ø¨Ø§Ù„ÙƒØ§Ù…Ù„

4. âœ… **DETAILED-TECHNICAL-REPORT-WORKSPACE-SWITCHER.md**
   - Ù…Ø³Ø§Ø­Ø© Ø§Ù„Ø¹Ù…Ù„ Ø¨Ø§Ù„ÙƒØ§Ù…Ù„

**ğŸ“Š ÙƒÙ„ ØªÙ‚Ø±ÙŠØ± ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰:**
- Ø§Ù„Ù…Ø³Ø§Ø±Ø§Øª ÙˆØ§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„ÙƒØ§Ù…Ù„Ø©
- Ø§Ù„ØªØ¹Ø§Ø±ÙŠÙ ÙˆØ§Ù„Ø£Ù†ÙˆØ§Ø¹ (TypeScript)
- Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø§Ø³ØªÙŠØ±Ø§Ø¯Ø§Øª
- State Management Ø§Ù„ÙƒØ§Ù…Ù„
- Ø§Ù„Ø¯ÙˆØ§Ù„ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© Ù…Ø¹ Ø§Ù„Ø´Ø±Ø­
- Ø§Ø³ØªØ¯Ø¹Ø§Ø¡Ø§Øª API
- Ø§Ù„Ø±Ø¨Ø· Ù…Ø¹ Ø§Ù„Ø£Ù†Ø¸Ù…Ø©
- ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
- Ø³ÙŠØ± Ø§Ù„Ø¹Ù…Ù„

**ğŸ¯ Ù‡Ø°Ù‡ Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± production-ready ÙˆÙŠÙ…ÙƒÙ† Ø§Ø³ØªØ®Ø¯Ø§Ù…Ù‡Ø§ Ù…Ø¨Ø§Ø´Ø±Ø©!**
